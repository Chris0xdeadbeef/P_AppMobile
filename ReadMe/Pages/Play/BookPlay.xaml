<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="ReadMe.Pages.Play.BookPlay"
    NavigationPage.HasNavigationBar="False"
    BackgroundColor="#0B0B0B">

    <Grid RowDefinitions="80,*">

        <!-- TOP BAR -->
        <Grid Grid.Row="0" HeightRequest="80">
            <BoxView Color="Black" />

            <!-- Bouton retour -->
            <ImageButton
                Source="backarrow.png"
                HeightRequest="70"
                WidthRequest="70"
                Margin="15,0"
                HorizontalOptions="Start"
                VerticalOptions="Center"
                Clicked="OnBackClicked" />

            <!-- Bouton page précédente -->
            <ImageButton         
                BackgroundColor="Red"
                HeightRequest="50"
                WidthRequest="50"
                Margin="100,0,0,0"
                HorizontalOptions="Start"
                VerticalOptions="Center"
                Clicked="OnPrevPageClicked" />

            <!-- Bouton page suivante -->
            <ImageButton
                BackgroundColor="ForestGreen"
                HeightRequest="50"
                WidthRequest="50"
                Margin="160,0,0,0"
                HorizontalOptions="Start"
                VerticalOptions="Center"
                Clicked="OnNextPageClicked" />

            <!-- Badge pages -->
            <Grid
                HorizontalOptions="End"
                VerticalOptions="Center"
                Margin="0,0,16,0">

                <Image
                    Source="bgpages.jpg"
                    Aspect="AspectFill"
                    Opacity="0.40"
                    HeightRequest="34"
                    WidthRequest="78" />

                <Border
                    HeightRequest="34"
                    WidthRequest="78"
                    Stroke="#22FFFFFF"
                    StrokeThickness="1"
                    StrokeShape="RoundRectangle 12">

                    <Border.Background>
                        <SolidColorBrush Color="#AA000000" />
                    </Border.Background>

                    <Grid Padding="10,6">
                        <Label
                            x:Name="PageIndicatorLabel"
                            Text="1/1"
                            TextColor="White"
                            FontSize="14"
                            FontAttributes="Bold"
                            HorizontalOptions="Center"
                            VerticalOptions="Center" />
                    </Grid>
                </Border>
            </Grid>
        </Grid>

        <!-- READER -->
        <Grid Grid.Row="1" x:Name="PageContainer" Padding="18" BackgroundColor="#0B0B0B">


            <!-- Carte -->
            <Frame
                x:Name="ReaderFrame"
                BackgroundColor="Transparent"
                CornerRadius="18"
                Padding="0"
                HasShadow="True">

                <!-- Grid pour avoir image de fond + contenu par-dessus -->
                <Grid>

                    <!-- Background de la carte -->
                    <Image
                        Source="bgpages.jpg"
                        Aspect="AspectFill"
                        Opacity="0.6"
                        InputTransparent="True" />

                    <!-- Contenu (WebView / cover / etc.) -->
                    <ContentView
                        x:Name="PageContent"
                        HorizontalOptions="Fill"
                        VerticalOptions="Fill"
                        Opacity="0.7"/>
                </Grid>
            </Frame>

            <!-- WebView caché -->
            <WebView
                x:Name="MeasureWebView"
                IsVisible="False"
                Opacity="0"
                InputTransparent="True"
                HeightRequest="1"
                WidthRequest="1" />

            <!-- Gestures -->
            <Grid.GestureRecognizers>
                <SwipeGestureRecognizer Direction="Left" Swiped="OnSwipeLeft" />
                <SwipeGestureRecognizer Direction="Right" Swiped="OnSwipeRight" />
            </Grid.GestureRecognizers>               
        </Grid>
    </Grid>
</ContentPage>